author: '@gott_cyber'
category: webserver
date: 2022/08/17
description: Detects an attempt to leverage the vulnerable servlet "mboximport" for
  an unauthenticated remote command injection
detection:
  condition: selection_servlet or selection_shell
  selection_servlet:
    http.http_method: POST
    http.url|contains: /service/extension/backup/mboximport\?
    http.url|contains|all:
    - account-name
    - ow
    - no-switch
    - append
    sc-status:
    - '401'
    - '200'
  selection_shell:
    cs-status|contains: '200'
    cs-uri|contains: /zimbraAdmin/
    cs-uri|endswith: .jsp
falsepositives:
- Unknown
id: dd218fb6-4d02-42dc-85f0-a0a376072efd
level: medium
logsource:
  category: webserver
  product: suricata
  service: http
product: suricata
references:
- https://www.volexity.com/blog/2022/08/10/mass-exploitation-of-unauthenticated-zimbra-rce-cve-2022-27925/
- https://www.yang99.top/index.php/archives/82/
- https://github.com/vnhacker1337/CVE-2022-27925-PoC
service: http
status: experimental
tags:
- attack.initial_access
- attack.t1190
- cve.2022.27925
title: Zimbra Collaboration Suite Email Server Unauthenticated RCE
