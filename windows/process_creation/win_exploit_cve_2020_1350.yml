author: Florian Roth
category: process_creation
date: 2020/07/15
description: Detects exploitation of DNS RCE bug reported in CVE-2020-1350 by the
  detection of suspicious sub process
detection:
  condition: selection and not filter
  filter:
    winlog.event_data.Image|endswith:
    - \System32\werfault.exe
    - \System32\conhost.exe
    - \System32\dnscmd.exe
  selection:
    winlog.event_data.ParentImage|endswith: \System32\dns.exe
falsepositives:
- Unknown but benign sub processes of the Windows DNS service dns.exe
id: b5281f31-f9cc-4d0d-95d0-45b91c45b487
level: critical
logsource:
  category: process_creation
  product: windows
product: windows
references:
- https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/
- https://blog.menasec.net/2019/02/threat-hunting-24-microsoft-windows-dns.html
status: experimental
tags:
- attack.initial_access
- attack.t1190
- attack.execution
- attack.t1569.002
title: DNS RCE CVE-2020-1350
