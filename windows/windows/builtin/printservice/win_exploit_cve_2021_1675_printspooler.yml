author: Florian Roth, KevTheHermit, fuzzyf10w, Tim Shelton
date: 2021/06/30
description: Detects events of driver load errors in print service logs that could
  be a sign of successful exploitation attempts of print spooler vulnerability CVE-2021-1675
detection:
  condition: (selection or keywords) and not falsepositive
  falsepositive:
  - ' registration timed out'
  keywords:
  - The print spooler failed to load a plug-in module
  - MyExploit.dll
  - evil.dll
  - \addCube.dll
  - \rev.dll
  - \rev2.dll
  - \main64.dll
  - \mimilib.dll
  - \mimispool.dll
  selection:
    ErrorCode:
    - '0x45A'
    - '0x7e'
    winlog.event_id:
    - 808
    - 4909
falsepositives:
- Problems with printer drivers
fields:
- PluginDllName
id: 4e64668a-4da1-49f5-a8df-9e2d5b866718
level: high
logsource:
  product: windows
  service: printservice-admin
modified: 2022/06/22
product: windows
references:
- https://github.com/hhlxf/PrintNightmare
- https://github.com/afwu/PrintNightmare
- https://twitter.com/fuzzyf10w/status/1410202370835898371
service: printservice-admin
status: experimental
tags:
- attack.execution
- attack.t1569
- cve.2021.1675
title: Possible CVE-2021-1675 Print Spooler Exploitation
