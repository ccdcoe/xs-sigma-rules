author: Nasreddine Bencherchali
date: 2022/08/05
description: Detects when someone is adding or removing applications or folder from
  exploit guard "ProtectedFolders" and "AllowedApplications"
detection:
  allowed_apps_key:
    NewValue|contains: \SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit
      Guard\Controlled Folder Access\AllowedApplications\
    winlog.event_id: 5007
  allowed_apps_path:
    NewValue|contains:
    - \Users\Public\
    - \AppData\Local\Temp\
    - \Desktop\
    - \PerfLogs\
    - \Windows\Temp\
  condition: all of allowed_apps* or protected_folders
  protected_folders:
    OldValue|contains: \SOFTWARE\Microsoft\Windows Defender\Windows Defender Exploit
      Guard\Controlled Folder Access\ProtectedFolders\
    winlog.event_id: 5007
falsepositives:
- Unlikely
id: a3ab73f1-bd46-4319-8f06-4b20d0617886
level: high
logsource:
  product: windows
  service: windefend
product: windows
references:
- https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088
service: windefend
status: experimental
tags:
- attack.execution
- attack.t1059
title: Windows Defender Exploit Guard Tamper
