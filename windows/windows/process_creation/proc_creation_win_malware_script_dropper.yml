author: Margaritis Dimitrios (idea), Florian Roth (rule), oscd.community
category: process_creation
date: 2019/01/16
description: Detects wscript/cscript executions of scripts located in user directories
detection:
  condition: selection1 and selection2 and not falsepositive
  falsepositive:
    winlog.event_data.ParentImage|contains: \winzip
  selection1:
    winlog.event_data.CommandLine|contains:
    - C:\Users\
    - C:\ProgramData\
    winlog.event_data.Image|endswith:
    - \wscript.exe
    - \cscript.exe
  selection2:
    winlog.event_data.CommandLine|contains:
    - .jse
    - .vbe
    - .js
    - .vba
    - .vbs
falsepositives:
- Winzip
- Other self-extractors
fields:
- winlog.event_data.CommandLine
- winlog.event_data.ParentCommandLine
id: cea72823-df4d-4567-950c-0b579eaf0846
level: high
logsource:
  category: process_creation
  product: windows
modified: 2021/11/27
product: windows
status: test
tags:
- attack.execution
- attack.t1059.005
- attack.t1059.007
title: WScript or CScript Dropper
