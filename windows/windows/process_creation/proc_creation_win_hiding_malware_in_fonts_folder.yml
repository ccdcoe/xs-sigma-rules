author: Sreeman
category: process_creation
date: 2020/04/21
description: Monitors for the hiding possible malicious files in the C:\Windows\Fonts\
  location. This folder doesn't require admin privillege to be written and executed
  from.
detection:
  condition: all of selection_*
  selection_1:
    winlog.event_data.CommandLine|contains:
    - echo
    - copy
    - type
    - file createnew
    - cacls
  selection_2:
    winlog.event_data.CommandLine|contains: C:\Windows\Fonts\
  selection_3:
    winlog.event_data.CommandLine|contains:
    - .sh
    - .exe
    - .dll
    - .bin
    - .bat
    - .cmd
    - .js
    - .msh
    - .reg
    - .scr
    - .ps
    - .vb
    - .jar
    - .pl
    - '.inf'
    - .cpl
    - .hta
    - .msi
    - .vbs
falsepositives:
- Unknown
fields:
- winlog.event_data.CommandLine
- winlog.event_data.ParentProcess
- winlog.event_data.CommandLine
id: ae9b0bd7-8888-4606-b444-0ed7410cb728
level: medium
logsource:
  category: process_creation
  product: windows
modified: 2022/03/08
product: windows
references:
- https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/
status: experimental
tags:
- attack.t1211
- attack.t1059
- attack.defense_evasion
- attack.persistence
title: Writing Of Malicious Files To The Fonts Folder
